Sub 汇总多个工作簿()

Dim File As String
Dim i&, j&
Dim wb As Object

Application.ScreenUpdating = False

File = Dir(ThisWorkbook.Path & "\*.xlsx")  '获取文件夹中第一张表的名称，*表示通配符

Do While Len(File)

    Set wb = Workbooks.Open(ThisWorkbook.Path & "\" & File) '打开文件
    
    i = wb.Sheets(1).Range("a1048576").End(xlUp).Row '判断打开的文件的有多少行
    
    '将打开的文件内容复制到当前工作簿
    wb.Sheets(1).Range("A2:I" & i).Copy Destination:=ThisWorkbook.Sheets(1).Range("A1048576").End(xlUp).Offset(1, 0)
    

    wb.Close False '不保存退出
    
    File = Dir()
    
Loop

Application.ScreenUpdating = False
   
End Sub
